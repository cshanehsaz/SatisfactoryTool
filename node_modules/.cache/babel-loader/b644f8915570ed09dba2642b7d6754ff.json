{"ast":null,"code":"export default class MachineNode {\n  constructor(_name, _maxInput1, _maxInput2, _maxInput3, _maxInput4, _output) {\n    this.name = _name;\n    this.children = [];\n    this.maxInput1 = _maxInput1; // {name:, amount:, max: }\n\n    this.maxInput2 = _maxInput2;\n    this.maxInput3 = _maxInput3;\n    this.maxInput4 = _maxInput4;\n    this.input = []; //[{name: a, amount:x}, ...]\n\n    this.output = _output; // this.width;\n    // this.height;\n    // this.cost = [];\n  }\n\n  getInput() {\n    return this.input;\n  }\n\n  getOutput() {\n    return this.output;\n  }\n\n  getChildren() {\n    return this.children;\n  }\n\n  getMaxInput1() {\n    return this.maxInput1;\n  }\n\n  getMaxInput2() {\n    return this.maxInput2;\n  }\n\n  getMaxInput3() {\n    return this.maxInput3;\n  }\n\n  getMaxInput4() {\n    return this.maxInput4;\n  }\n\n  getMaxInput() {\n    return [this.getMaxInput1(), this.getMaxInput2(), this.getMaxInput3(), this.getMaxInput4()];\n  }\n\n  getAvailableInput(material) {\n    return this.getMaxInputAmount(material) - this.getInputAmount(material);\n  }\n\n  addInput(_name, _amount) {\n    if (this.getInputAmount(_name) >= 0) {}\n\n    this.input.push({\n      name: _name,\n      amount: _amount\n    });\n  } //needs to be updated or deprecated\n\n\n  addMaxInput(_name, _amount) {\n    this.maxInput.push({\n      name: _name,\n      amount: _amount\n    });\n  }\n\n  addOutput(_name, _amount) {\n    this.output = {\n      name: _name,\n      amount: _amount\n    };\n  }\n\n  getInputAmount(material) {\n    if (this.getInput().length < 1) {\n      return 0;\n    }\n\n    for (let input of this.getInput()) {\n      if (input.name === material) {\n        return input.amount;\n      } else {\n        return -1;\n      }\n    }\n  }\n\n  getMaxInputAmount(material) {\n    for (let input of this.getMaxInput()) {\n      if (input.name === material) {\n        return input.amount;\n      }\n    }\n\n    return -1;\n  } // edit this so that it correctly splits the output \n  // and records how much of what is sent to which child\n\n\n  sendOutput() {\n    let material = this.getOutput().name;\n    let children = this.getChildren();\n    let effected = [];\n    let prevConsumption = 0;\n    let consumption = 0; //total amount of output consumed by children\n\n    for (let child of children) {\n      consumption += child.getAvailableInput(material);\n    }\n\n    console.log(\"material: \" + material);\n    console.log(\"consumption: \" + consumption);\n    let remainingOutput = this.getOutput().amount;\n\n    if (consumption >= this.getOutput().amount) {\n      //if consumption > output, split evenly\n      let split = Math.round(this.getOutput().amount / children.length);\n\n      for (let child of children) {\n        child.addInput(material, Math.min(split + child.getInputAmount(material), child.getMaxInputAmount(material)));\n      }\n    } else {\n      //split so that each child gets their max input\n      for (let child of children) {\n        child.addInput(material, child.getMaxInputAmount(material));\n      }\n    }\n  }\n\n  splitOutput(material, amount, children) {\n    let countAtMax = 0; //if at full capacity don't count in the split\n\n    for (let child of children) {\n      if (child.getInputAmount(material) === child.getMaxInputAmount(material)) {\n        countAtMax += 1;\n      }\n    }\n\n    let split = Math.round(amount / (children.length - countAtMax));\n\n    for (let child of children) {\n      child.addInput(material, Math.min(split + child.getInputAmount(material), child.getMaxInputAmount(material)));\n      amount -= Math.min(split + child.getInputAmount(material), child.getMaxInputAmount(material));\n    }\n\n    if (amount > 0) {\n      this.splitOutput(material, amount, children);\n    }\n  }\n\n  addChild(_child) {\n    //sets a child node and adds parent\n    this.children.push(_child);\n  }\n\n  removeChild(_child) {\n    for (let child of this.getChildren()) {\n      if (_child === child) {\n        this.children = this.getChildren().filter(c => {\n          return c !== _child;\n        });\n      }\n    }\n  }\n\n  wipeInput() {\n    this.input = [];\n  }\n\n  wipeInputOutput() {\n    this.input = []; //[{name: a, amount:x}, ...]\n\n    this.output = {};\n  }\n\n  wipeChildrenInput() {\n    for (let child of this.children) {\n      child.wipeInput();\n    }\n  }\n\n  wipeChildren() {\n    this.children = [];\n  }\n\n  wipeAll() {\n    this.children = [];\n    this.maxInput = [];\n    this.input = []; //[{name: a, amount:x}, ...]\n\n    this.output = {};\n  }\n\n}","map":{"version":3,"sources":["C:/Users/cshan/Box Sync/website/satisfactory2/src/backend/machineNode.js"],"names":["MachineNode","constructor","_name","_maxInput1","_maxInput2","_maxInput3","_maxInput4","_output","name","children","maxInput1","maxInput2","maxInput3","maxInput4","input","output","getInput","getOutput","getChildren","getMaxInput1","getMaxInput2","getMaxInput3","getMaxInput4","getMaxInput","getAvailableInput","material","getMaxInputAmount","getInputAmount","addInput","_amount","push","amount","addMaxInput","maxInput","addOutput","length","sendOutput","effected","prevConsumption","consumption","child","console","log","remainingOutput","split","Math","round","min","splitOutput","countAtMax","addChild","_child","removeChild","filter","c","wipeInput","wipeInputOutput","wipeChildrenInput","wipeChildren","wipeAll"],"mappings":"AAAA,eAAe,MAAMA,WAAN,CAAkB;AAC7BC,EAAAA,WAAW,CAACC,KAAD,EAAQC,UAAR,EAAoBC,UAApB,EAAgCC,UAAhC,EAA4CC,UAA5C,EAAwDC,OAAxD,EAAiE;AACxE,SAAKC,IAAL,GAAYN,KAAZ;AACA,SAAKO,QAAL,GAAgB,EAAhB;AACA,SAAKC,SAAL,GAAiBP,UAAjB,CAHwE,CAG3C;;AAC7B,SAAKQ,SAAL,GAAiBP,UAAjB;AACA,SAAKQ,SAAL,GAAiBP,UAAjB;AACA,SAAKQ,SAAL,GAAiBP,UAAjB;AACA,SAAKQ,KAAL,GAAa,EAAb,CAPwE,CAOvD;;AACjB,SAAKC,MAAL,GAAcR,OAAd,CARwE,CASxE;AACA;AACA;AACH;;AAEDS,EAAAA,QAAQ,GAAG;AACP,WAAQ,KAAKF,KAAb;AACH;;AAEDG,EAAAA,SAAS,GAAG;AACR,WAAQ,KAAKF,MAAb;AACH;;AAEDG,EAAAA,WAAW,GAAG;AACV,WAAQ,KAAKT,QAAb;AACH;;AAEDU,EAAAA,YAAY,GAAG;AACX,WAAQ,KAAKT,SAAb;AACH;;AAEDU,EAAAA,YAAY,GAAG;AACX,WAAQ,KAAKT,SAAb;AACH;;AAEDU,EAAAA,YAAY,GAAG;AACX,WAAQ,KAAKT,SAAb;AACH;;AAEDU,EAAAA,YAAY,GAAG;AACX,WAAQ,KAAKT,SAAb;AACH;;AAEDU,EAAAA,WAAW,GAAG;AACV,WAAO,CACH,KAAKJ,YAAL,EADG,EACkB,KAAKC,YAAL,EADlB,EACuC,KAAKC,YAAL,EADvC,EAC4D,KAAKC,YAAL,EAD5D,CAAP;AAGH;;AAEDE,EAAAA,iBAAiB,CAACC,QAAD,EAAW;AACxB,WAAO,KAAKC,iBAAL,CAAuBD,QAAvB,IAAmC,KAAKE,cAAL,CAAoBF,QAApB,CAA1C;AACH;;AAEDG,EAAAA,QAAQ,CAAC1B,KAAD,EAAQ2B,OAAR,EAAiB;AACrB,QAAG,KAAKF,cAAL,CAAoBzB,KAApB,KAA8B,CAAjC,EAAoC,CAEnC;;AACD,SAAKY,KAAL,CAAWgB,IAAX,CAAgB;AACZtB,MAAAA,IAAI,EAAEN,KADM;AAEZ6B,MAAAA,MAAM,EAAEF;AAFI,KAAhB;AAIH,GA7D4B,CA+D7B;;;AACAG,EAAAA,WAAW,CAAC9B,KAAD,EAAQ2B,OAAR,EAAiB;AACxB,SAAKI,QAAL,CAAcH,IAAd,CAAmB;AACftB,MAAAA,IAAI,EAAEN,KADS;AAEf6B,MAAAA,MAAM,EAAEF;AAFO,KAAnB;AAIH;;AAEDK,EAAAA,SAAS,CAAChC,KAAD,EAAQ2B,OAAR,EAAiB;AACtB,SAAKd,MAAL,GAAc;AACVP,MAAAA,IAAI,EAAEN,KADI;AAEV6B,MAAAA,MAAM,EAAEF;AAFE,KAAd;AAIH;;AAEDF,EAAAA,cAAc,CAACF,QAAD,EAAW;AACrB,QAAG,KAAKT,QAAL,GAAgBmB,MAAhB,GAAyB,CAA5B,EAA+B;AAAE,aAAO,CAAP;AAAW;;AAC5C,SAAK,IAAIrB,KAAT,IAAkB,KAAKE,QAAL,EAAlB,EAAmC;AAC/B,UAAGF,KAAK,CAACN,IAAN,KAAeiB,QAAlB,EAA4B;AAAE,eAAQX,KAAK,CAACiB,MAAd;AAAuB,OAArD,MACK;AAAE,eAAQ,CAAC,CAAT;AAAa;AACvB;AACJ;;AAEDL,EAAAA,iBAAiB,CAACD,QAAD,EAAW;AACxB,SAAK,IAAIX,KAAT,IAAkB,KAAKS,WAAL,EAAlB,EAAsC;AAClC,UAAGT,KAAK,CAACN,IAAN,KAAeiB,QAAlB,EAA4B;AAAE,eAAOX,KAAK,CAACiB,MAAb;AAAsB;AACvD;;AACD,WAAO,CAAC,CAAR;AACH,GA3F4B,CA8F7B;AACA;;;AACAK,EAAAA,UAAU,GAAG;AACT,QAAIX,QAAQ,GAAG,KAAKR,SAAL,GAAiBT,IAAhC;AACA,QAAIC,QAAQ,GAAG,KAAKS,WAAL,EAAf;AACA,QAAImB,QAAQ,GAAG,EAAf;AACA,QAAIC,eAAe,GAAG,CAAtB;AACA,QAAIC,WAAW,GAAG,CAAlB,CALS,CAKY;;AAErB,SAAK,IAAIC,KAAT,IAAkB/B,QAAlB,EAA4B;AACxB8B,MAAAA,WAAW,IAAIC,KAAK,CAAChB,iBAAN,CAAwBC,QAAxB,CAAf;AACH;;AAEDgB,IAAAA,OAAO,CAACC,GAAR,CAAY,eAAejB,QAA3B;AACAgB,IAAAA,OAAO,CAACC,GAAR,CAAY,kBAAkBH,WAA9B;AAEA,QAAII,eAAe,GAAG,KAAK1B,SAAL,GAAiBc,MAAvC;;AACA,QAAIQ,WAAW,IAAI,KAAKtB,SAAL,GAAiBc,MAApC,EAA4C;AAAE;AAC1C,UAAIa,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAW,KAAK7B,SAAL,GAAiBc,MAAjB,GAA0BtB,QAAQ,CAAC0B,MAA9C,CAAZ;;AACA,WAAK,IAAIK,KAAT,IAAkB/B,QAAlB,EAA4B;AACxB+B,QAAAA,KAAK,CAACZ,QAAN,CACIH,QADJ,EAEIoB,IAAI,CAACE,GAAL,CAASH,KAAK,GAACJ,KAAK,CAACb,cAAN,CAAqBF,QAArB,CAAf,EAA+Ce,KAAK,CAACd,iBAAN,CAAwBD,QAAxB,CAA/C,CAFJ;AAIH;AACJ,KARD,MAUK;AAAE;AACH,WAAK,IAAIe,KAAT,IAAkB/B,QAAlB,EAA4B;AACxB+B,QAAAA,KAAK,CAACZ,QAAN,CAAeH,QAAf,EAAyBe,KAAK,CAACd,iBAAN,CAAwBD,QAAxB,CAAzB;AACH;AACJ;AAEJ;;AAEDuB,EAAAA,WAAW,CAACvB,QAAD,EAAWM,MAAX,EAAmBtB,QAAnB,EAA6B;AACpC,QAAIwC,UAAU,GAAG,CAAjB,CADoC,CAEpC;;AACA,SAAI,IAAIT,KAAR,IAAiB/B,QAAjB,EAA2B;AACvB,UAAG+B,KAAK,CAACb,cAAN,CAAqBF,QAArB,MAAmCe,KAAK,CAACd,iBAAN,CAAwBD,QAAxB,CAAtC,EAAyE;AAAEwB,QAAAA,UAAU,IAAI,CAAd;AAAiB;AAC/F;;AAED,QAAIL,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAWf,MAAM,IAAItB,QAAQ,CAAC0B,MAAT,GAAkBc,UAAtB,CAAjB,CAAZ;;AAEA,SAAK,IAAIT,KAAT,IAAkB/B,QAAlB,EAA4B;AACxB+B,MAAAA,KAAK,CAACZ,QAAN,CACIH,QADJ,EAEIoB,IAAI,CAACE,GAAL,CAASH,KAAK,GAACJ,KAAK,CAACb,cAAN,CAAqBF,QAArB,CAAf,EAA+Ce,KAAK,CAACd,iBAAN,CAAwBD,QAAxB,CAA/C,CAFJ;AAIAM,MAAAA,MAAM,IAAIc,IAAI,CAACE,GAAL,CAASH,KAAK,GAACJ,KAAK,CAACb,cAAN,CAAqBF,QAArB,CAAf,EAA+Ce,KAAK,CAACd,iBAAN,CAAwBD,QAAxB,CAA/C,CAAV;AACH;;AAED,QAAGM,MAAM,GAAG,CAAZ,EAAe;AACX,WAAKiB,WAAL,CAAiBvB,QAAjB,EAA2BM,MAA3B,EAAmCtB,QAAnC;AACH;AACJ;;AAEDyC,EAAAA,QAAQ,CAACC,MAAD,EAAS;AAAE;AACf,SAAK1C,QAAL,CAAcqB,IAAd,CAAmBqB,MAAnB;AACH;;AAEDC,EAAAA,WAAW,CAACD,MAAD,EAAS;AAChB,SAAK,IAAIX,KAAT,IAAkB,KAAKtB,WAAL,EAAlB,EAAsC;AAClC,UAAIiC,MAAM,KAAKX,KAAf,EAAsB;AAClB,aAAK/B,QAAL,GAAgB,KAAKS,WAAL,GAAmBmC,MAAnB,CAA4BC,CAAD,IAAO;AAC9C,iBAAQA,CAAC,KAAKH,MAAd;AACH,SAFe,CAAhB;AAGH;AACJ;AACJ;;AAEDI,EAAAA,SAAS,GAAG;AACR,SAAKzC,KAAL,GAAa,EAAb;AACH;;AAED0C,EAAAA,eAAe,GAAG;AACd,SAAK1C,KAAL,GAAa,EAAb,CADc,CACG;;AACjB,SAAKC,MAAL,GAAc,EAAd;AACH;;AAED0C,EAAAA,iBAAiB,GAAG;AAChB,SAAI,IAAIjB,KAAR,IAAiB,KAAK/B,QAAtB,EAAgC;AAC5B+B,MAAAA,KAAK,CAACe,SAAN;AACH;AACJ;;AAEDG,EAAAA,YAAY,GAAG;AACX,SAAKjD,QAAL,GAAgB,EAAhB;AACH;;AAEDkD,EAAAA,OAAO,GAAG;AACN,SAAKlD,QAAL,GAAgB,EAAhB;AACA,SAAKwB,QAAL,GAAgB,EAAhB;AACA,SAAKnB,KAAL,GAAa,EAAb,CAHM,CAGW;;AACjB,SAAKC,MAAL,GAAc,EAAd;AACH;;AA7L4B","sourcesContent":["export default class MachineNode {\r\n    constructor(_name, _maxInput1, _maxInput2, _maxInput3, _maxInput4, _output) {\r\n        this.name = _name;\r\n        this.children = [];\r\n        this.maxInput1 = _maxInput1; // {name:, amount:, max: }\r\n        this.maxInput2 = _maxInput2;\r\n        this.maxInput3 = _maxInput3;\r\n        this.maxInput4 = _maxInput4;\r\n        this.input = []; //[{name: a, amount:x}, ...]\r\n        this.output = _output;\r\n        // this.width;\r\n        // this.height;\r\n        // this.cost = [];\r\n    }\r\n\r\n    getInput() {\r\n        return (this.input)\r\n    }\r\n\r\n    getOutput() {\r\n        return (this.output)\r\n    }\r\n\r\n    getChildren() {\r\n        return (this.children)\r\n    }\r\n\r\n    getMaxInput1() {\r\n        return (this.maxInput1)\r\n    }\r\n\r\n    getMaxInput2() {\r\n        return (this.maxInput2)\r\n    }\r\n\r\n    getMaxInput3() {\r\n        return (this.maxInput3)\r\n    }\r\n\r\n    getMaxInput4() {\r\n        return (this.maxInput4)\r\n    }\r\n\r\n    getMaxInput() {\r\n        return([\r\n            this.getMaxInput1(), this.getMaxInput2(), this.getMaxInput3(), this.getMaxInput4()\r\n        ])\r\n    }\r\n\r\n    getAvailableInput(material) {\r\n        return(this.getMaxInputAmount(material) - this.getInputAmount(material))\r\n    }\r\n\r\n    addInput(_name, _amount) {\r\n        if(this.getInputAmount(_name) >= 0) {\r\n\r\n        }\r\n        this.input.push({\r\n            name: _name, \r\n            amount: _amount\r\n        })\r\n    }\r\n\r\n    //needs to be updated or deprecated\r\n    addMaxInput(_name, _amount) {\r\n        this.maxInput.push({\r\n            name: _name, \r\n            amount: _amount\r\n        })\r\n    }\r\n\r\n    addOutput(_name, _amount) {\r\n        this.output = {\r\n            name: _name,\r\n            amount: _amount\r\n        }\r\n    }\r\n\r\n    getInputAmount(material) {\r\n        if(this.getInput().length < 1) { return(0) }\r\n        for (let input of this.getInput()) {\r\n            if(input.name === material) { return (input.amount) }\r\n            else { return (-1) }\r\n        }\r\n    }\r\n\r\n    getMaxInputAmount(material) {\r\n        for (let input of this.getMaxInput()) {\r\n            if(input.name === material) { return(input.amount) } \r\n        }\r\n        return(-1)\r\n    }\r\n\r\n\r\n    // edit this so that it correctly splits the output \r\n    // and records how much of what is sent to which child\r\n    sendOutput() { \r\n        let material = this.getOutput().name\r\n        let children = this.getChildren()\r\n        let effected = [];\r\n        let prevConsumption = 0;\r\n        let consumption = 0; //total amount of output consumed by children\r\n\r\n        for (let child of children) { \r\n            consumption += child.getAvailableInput(material)\r\n        }\r\n\r\n        console.log(\"material: \" + material)\r\n        console.log(\"consumption: \" + consumption)\r\n\r\n        let remainingOutput = this.getOutput().amount\r\n        if (consumption >= this.getOutput().amount) { //if consumption > output, split evenly\r\n            let split = Math.round(this.getOutput().amount / children.length)\r\n            for (let child of children) {\r\n                child.addInput(\r\n                    material, \r\n                    Math.min(split+child.getInputAmount(material), child.getMaxInputAmount(material))\r\n                )\r\n            }\r\n        } \r\n        \r\n        else { //split so that each child gets their max input\r\n            for (let child of children) {\r\n                child.addInput(material, child.getMaxInputAmount(material))\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    splitOutput(material, amount, children) {\r\n        let countAtMax = 0;\r\n        //if at full capacity don't count in the split\r\n        for(let child of children) {\r\n            if(child.getInputAmount(material) === child.getMaxInputAmount(material)) { countAtMax += 1 }\r\n        }\r\n\r\n        let split = Math.round(amount / (children.length - countAtMax) )\r\n\r\n        for (let child of children) {\r\n            child.addInput(\r\n                material, \r\n                Math.min(split+child.getInputAmount(material), child.getMaxInputAmount(material))\r\n            )\r\n            amount -= Math.min(split+child.getInputAmount(material), child.getMaxInputAmount(material))\r\n        }\r\n\r\n        if(amount > 0) {\r\n            this.splitOutput(material, amount, children)\r\n        }\r\n    }\r\n\r\n    addChild(_child) { //sets a child node and adds parent\r\n        this.children.push(_child);\r\n    }\r\n    \r\n    removeChild(_child) {\r\n        for (let child of this.getChildren()) {\r\n            if (_child === child) {\r\n                this.children = this.getChildren().filter( (c) => {\r\n                    return (c !== _child)\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    wipeInput() {\r\n        this.input = [];\r\n    }\r\n\r\n    wipeInputOutput() {\r\n        this.input = []; //[{name: a, amount:x}, ...]\r\n        this.output = {};\r\n    }\r\n\r\n    wipeChildrenInput() {\r\n        for(let child of this.children) {\r\n            child.wipeInput()\r\n        }\r\n    }\r\n\r\n    wipeChildren() {\r\n        this.children = [];\r\n    }\r\n\r\n    wipeAll() {\r\n        this.children = [];\r\n        this.maxInput = [];\r\n        this.input = []; //[{name: a, amount:x}, ...]\r\n        this.output = {};\r\n    }\r\n\r\n}"]},"metadata":{},"sourceType":"module"}